{% extends "base.html" %}
{% block title %}Factura {{ transaccion_id[:8] }}{% endblock %}
{% block styles %}
<style>
    .invoice-container { max-width: 800px; margin: auto; background-color: var(--surface-white); padding: 40px; }
    @media print {
        body { background-color: #fff !important; color: #000 !important; }
        main.container { padding: 0 !important; margin: 0 !important; }
        .invoice-container { color: #000 !important; background-color: #fff !important; box-shadow: none !important; margin: 0 !important; max-width: 100%; border-radius: 0;}
        .table { color: #000 !important; }
        .text-white, .text-muted, .text-primary, .lead { color: #000 !important; }
        .no-print { display: none !important; }
    }
</style>
{% endblock %}
{% block content %}
<div class="invoice-container rounded shadow-sm">
    <div class="d-flex justify-content-between align-items-start mb-4">
        <div>
            <h2 class="fw-bold text-primary mb-1">{{ empresa.nombre_empresa }}</h2>
            <p class="text-muted mb-0">{{ empresa.direccion }}<br>Tel: {{ empresa.telefono }} | RNC: {{ empresa.rnc }}</p>
        </div>
        <h1 class="display-4 text-muted">FACTURA</h1>
    </div>
    <div class="d-flex justify-content-between align-items-start mb-4 p-3 border rounded">
        <div><strong class="text-muted">FACTURAR A:</strong><br>{{ cliente_nombre }}<br>{% if cliente_telefono %}Tel: {{ cliente_telefono }}{% endif %}</div>
        <div class="text-end"><strong class="text-muted">Factura #:</strong> {{ transaccion_id[:8].upper() }}<br><strong class="text-muted">Fecha:</strong> {{ fecha_venta }}</div>
    </div>
    <table class="table table-bordered">
        <thead><tr class="table-light"><th>Descripci√≥n</th><th class="text-center">Cantidad</th><th class="text-end">Precio Unit.</th><th class="text-end">Subtotal</th></tr></thead>
        <tbody>
            {% for item in items_vendidos %}
            <tr><td>{{ item.nombre }}</td><td class="text-center">{{ item.cantidad }}</td><td class="text-end">${{ "%.2f"|format(item.precio_total / item.cantidad) }}</td><td class="text-end">${{ "%.2f"|format(item.precio_total) }}</td></tr>
            {% endfor %}
        </tbody>
        <tfoot><tr><td colspan="2"></td><td class="text-end fw-bold align-middle">TOTAL</td><td class="text-end fw-bold fs-4 text-primary">${{ "%.2f"|format(total_general) }}</td></tr></tfoot>
    </table>
    <div class="text-center mt-4 no-print">
        <button onclick="window.print()" class="btn btn-primary"><i class="bi bi-printer me-1"></i> Imprimir Factura</button>
    </div>
</div>
{% endblock %}